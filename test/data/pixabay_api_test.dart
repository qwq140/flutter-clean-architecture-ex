import 'package:flutter_test/flutter_test.dart';
import 'package:image_search/data/pixabay_api.dart';
import 'package:mockito/annotations.dart';
import 'package:http/http.dart' as http;
import 'package:mockito/mockito.dart';

import 'pixabay_api_test.mocks.dart';

@GenerateMocks([http.Client])
void main() {
  test('Pixabay 데이터를 잘 가져와야 한다.', () async {
    final api = PixabayApi();

    final client = MockClient();
    when(client.get(Uri.parse('${PixabayApi.baseUrl}?key=${PixabayApi.key}&q=iphone&image_type=photo')))
      .thenAnswer((_) async => http.Response(fakeJsonBody, 200));

    final result = await api.fetch('iphone', client: client);

    expect(result.first.id, 2681039);

    verify(client.get(Uri.parse('${PixabayApi.baseUrl}?key=${PixabayApi.key}&q=iphone&image_type=photo')));
  });
}

String fakeJsonBody = """
{"total":8693,"totalHits":500,"hits":[{"id":2681039,"pageURL":"https://pixabay.com/photos/phone-wallpaper-watercolor-painting-2681039/","type":"photo","tags":"phone wallpaper, watercolor, painting","previewURL":"https://cdn.pixabay.com/photo/2017/08/25/18/48/watercolor-2681039_150.jpg","previewWidth":99,"previewHeight":150,"webformatURL":"https://pixabay.com/get/g18b3f449cf18298be868f0156adfc14f57e5c113fc6d5f084099274868bc2ecd36129a8b2414120a6ddc7668120eda2c749a2ffb6ba861012069f8a14545837e_640.jpg","webformatWidth":424,"webformatHeight":640,"largeImageURL":"https://pixabay.com/get/gcbadf672d11c944f7955bca7885ab97e9a09005f6c8fd86719175fda3029a53d95a692c65f97d42e12e104045307a9d2e65a1817a46b603e00aef503f2880d19_1280.jpg","imageWidth":3264,"imageHeight":4928,"imageSize":5021313,"views":1065449,"downloads":816209,"collections":1889,"likes":1191,"comments":132,"user_id":4894494,"user":"eluela31","userImageURL":"https://cdn.pixabay.com/user/2017/04/24/19-55-29-652_250x250.jpg"},{"id":1599527,"pageURL":"https://pixabay.com/photos/phone-wallpaper-mystery-island-1599527/","type":"photo","tags":"phone wallpaper, mystery, island","previewURL":"https://cdn.pixabay.com/photo/2016/08/17/01/39/mystery-1599527_150.jpg","previewWidth":116,"previewHeight":150,"webformatURL":"https://pixabay.com/get/g109757962083a6d2cdfb74cee334ef513e10d12d6dea5579bdfefdb5fd8b84f8dfda6b48f26623e853c4365887f85ebdc8a48d0e8bb04f452386f435ee2ca75e_640.jpg","webformatWidth":495,"webformatHeight":640,"largeImageURL":"https://pixabay.com/get/g6c488be83a8ef4cda6082c4a0cbb939f11a7d58fe58772e306a969644c7aaf8a4d131def809906c0b81a89735987dca829f0b349c5449d7007519de433beb2b3_1280.jpg","imageWidth":3022,"imageHeight":3907,"imageSize":3563541,"views":705744,"downloads":369495,"collections":1374,"likes":1332,"comments":163,"user_id":2633886,"user":"intographics","userImageURL":"https://cdn.pixabay.com/user/2019/02/11/15-00-48-80_250x250.jpg"},{"id":620817,"pageURL":"https://pixabay.com/photos/office-notes-notepad-entrepreneur-620817/","type":"photo","tags":"office, notes, notepad","previewURL":"https://cdn.pixabay.com/photo/2015/02/02/11/08/office-620817_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/gcc5b4a918d68ccd51e66af12a15f70fae1ba298691a410a1e1845144df86f6e3f44395787220a4830310ca57fecba944_640.jpg","webformatWidth":640,"webformatHeight":425,"largeImageURL":"https://pixabay.com/get/g3a146db5c5ca788b2d5b46eb2334ff9d1138a0edc15315b6a4048413f0818d8306162b8c85a91791c9208693d7a2476b152d2ce252a78223d79291ad570caa6d_1280.jpg","imageWidth":4288,"imageHeight":2848,"imageSize":2800224,"views":742627,"downloads":323088,"collections":1333,"likes":1127,"comments":263,"user_id":663163,"user":"Firmbee","userImageURL":"https://cdn.pixabay.com/user/2020/11/25/09-38-28-431_250x250.png"},{"id":1914130,"pageURL":"https://pixabay.com/photos/phone-wallpaper-spices-spoons-salt-1914130/","type":"photo","tags":"phone wallpaper, spices, spoons","previewURL":"https://cdn.pixabay.com/photo/2016/12/17/18/51/spices-1914130_150.jpg","previewWidth":133,"previewHeight":150,"webformatURL":"https://pixabay.com/get/gd43a31a95500889f0775b564af7c78c9c4377c47676820db40220a6e5654a0c746a7b01d7b9545e48c023f00ead4301f400d2e867c612a6d897aa44c743059fc_640.jpg","webformatWidth":571,"webformatHeight":640,"largeImageURL":"https://pixabay.com/get/g8de18278830637d526c572aa72395de9b90ab06217a03b21947e72bd1a4d3ed7674c89a568cbacee91e28ff254b65779715814829505a8ed133754e07d69083a_1280.jpg","imageWidth":3581,"imageHeight":4013,"imageSize":6193655,"views":424902,"downloads":274438,"collections":1157,"likes":1220,"comments":161,"user_id":3938704,"user":"Daria-Yakovleva","userImageURL":"https://cdn.pixabay.com/user/2016/12/06/15-05-11-524_250x250.jpg"},{"id":1979674,"pageURL":"https://pixabay.com/photos/relaxing-lounging-saturday-cozy-1979674/","type":"photo","tags":"relaxing, lounging, saturday","previewURL":"https://cdn.pixabay.com/photo/2017/01/14/15/11/relaxing-1979674_150.jpg","previewWidth":150,"previewHeight":102,"webformatURL":"https://pixabay.com/get/g3379de9b93226bfc80a9379be8e3abca5af1416f60d79917b1accada55488192de41b4b3e7d7c373561042083cff886ff8600de4a1f868c8cf6a12441eb6c5ca_640.jpg","webformatWidth":640,"webformatHeight":438,"largeImageURL":"https://pixabay.com/get/g5808c02519438e9bb94a8de51b16102b0ba6826a9c8919cba9ee6e932cab1ee35bb21e2b1855dc3efc61312022e23e8d046f9a946165efa43332cdc23f0adfbd_1280.jpg","imageWidth":5310,"imageHeight":3637,"imageSize":3751070,"views":418868,"downloads":237540,"collections":1037,"likes":1159,"comments":146,"user_id":334088,"user":"JillWellington","userImageURL":"https://cdn.pixabay.com/user/2018/06/27/01-23-02-27_250x250.jpg"},{"id":410324,"pageURL":"https://pixabay.com/photos/iphone-smartphone-apps-apple-inc-410324/","type":"photo","tags":"iphone, smartphone, apps","previewURL":"https://cdn.pixabay.com/photo/2014/08/05/10/30/iphone-410324_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g1a4662e1398d6c0298fcb14ccd52b79eb24e36d6ac1b46b3e7ee2786e1cbb52120fe71c6146504aa131dbc7c0b6aa9c2_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/g1fb03b953ce5acec86fb92bd1801e8357c62f06ba0dd922481e2dedd06cf0a1735b8bbf5bc2a979172cd76315942bc3e539131b134c5f99b219d18e18ef999de_1280.jpg","imageWidth":2180,"imageHeight":1453,"imageSize":477025,"views":747344,"downloads":435804,"collections":894,"likes":799,"comments":217,"user_id":264599,"user":"JESHOOTS-com","userImageURL":"https://cdn.pixabay.com/user/2014/06/08/15-27-10-248_250x250.jpg"},{"id":2846221,"pageURL":"https://pixabay.com/photos/business-computer-mobile-smartphone-2846221/","type":"photo","tags":"business, computer, mobile","previewURL":"https://cdn.pixabay.com/photo/2017/10/12/22/17/business-2846221_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g30dceea99223a14ef164b426d14471654a5e358fed1865a4e2246dcf335b5b73b99a1cc0ac516fa8a9443b6e2a0691eb1a903c5bd51be7d786a9a00e20de4576_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/g65bafd3168b1434c4e8ad0d1fa6df2678728080f8d3ded0d0707f3f9ca7c9943dfa4e7f4fa39b6d1444bcff201f773cffa9d95fbd547f6f824201f32210c265a_1280.jpg","imageWidth":4608,"imageHeight":3072,"imageSize":2543501,"views":410466,"downloads":289747,"collections":1047,"likes":629,"comments":100,"user_id":6689062,"user":"6689062","userImageURL":""},{"id":459196,"pageURL":"https://pixabay.com/photos/macbook-laptop-google-display-459196/","type":"photo","tags":"macbook, laptop, google","previewURL":"https://cdn.pixabay.com/photo/2014/09/24/14/29/macbook-459196_150.jpg","previewWidth":150,"previewHeight":92,"webformatURL":"https://pixabay.com/get/g6aefde5bd7783beed30772300678323c5e2391c9eda78eb95454773a24e981ff1c80467fbd5acfc3b2ee201ffe8ebda8_640.jpg","webformatWidth":640,"webformatHeight":396,"largeImageURL":"https://pixabay.com/get/g5bd6c8702acf3649d4412324031a9f159dd9829501b2660974d8b6992697415ac2ed12fcd7529955a9b64cbc2383ba54232e05edced38c804d8280eb074b58e5_1280.jpg","imageWidth":3888,"imageHeight":2406,"imageSize":2883743,"views":574164,"downloads":290121,"collections":796,"likes":756,"comments":217,"user_id":377053,"user":"377053","userImageURL":""},{"id":1213475,"pageURL":"https://pixabay.com/photos/phone-wallpaper-heart-clouds-sky-1213475/","type":"photo","tags":"phone wallpaper, heart, clouds","previewURL":"https://cdn.pixabay.com/photo/2016/02/21/12/09/heart-1213475_150.jpg","previewWidth":100,"previewHeight":150,"webformatURL":"https://pixabay.com/get/gdf623150885e5ff00cc4abfc2255121fc7d39ba9ce4067deea828496a9ff185136bd101f382532dac9f63ebb889f38b2141480290b3667015232ebc07f32d206_640.jpg","webformatWidth":427,"webformatHeight":640,"largeImageURL":"https://pixabay.com/get/g9dcab830d1b61a82bb3e6caebb6453f462064a0dd892b0c3c8db1729b41a1b5c5a036a895030f344bbcf7ab4f1a16b3b079acc176e2c50389fd531ea9c5054c2_1280.jpg","imageWidth":1667,"imageHeight":2500,"imageSize":656080,"views":625463,"downloads":448515,"collections":786,"likes":804,"comments":110,"user_id":848168,"user":"oo11o","userImageURL":""},{"id":3746423,"pageURL":"https://pixabay.com/photos/ruin-castle-middle-ages-dramatic-3746423/","type":"photo","tags":"ruin, castle, middle ages","previewURL":"https://cdn.pixabay.com/photo/2018/10/14/13/01/ruin-3746423_150.jpg","previewWidth":106,"previewHeight":150,"webformatURL":"https://pixabay.com/get/g544a6692963cedb9784d4be8ec5553596a6c9522dbe42ebedc99f127e4f5c7006a9a11b4087fdad517a8e22fc6247189b1aab97708757076122da79fadfc233a_640.jpg","webformatWidth":452,"webformatHeight":640,"largeImageURL":"https://pixabay.com/get/g0a4716ad61eed2e57e35ab943b369de27830b9bb7f68d3a9d85acd8d8600439dd0708c0c9c7e138af616301060697a4a2f6118bd306fd47297ca9da6e3afd76c_1280.jpg","imageWidth":3508,"imageHeight":4961,"imageSize":4680479,"views":305120,"downloads":255896,"collections":819,"likes":687,"comments":134,"user_id":1664300,"user":"Darkmoon_Art","userImageURL":"https://cdn.pixabay.com/user/2022/09/27/12-51-07-71_250x250.jpg"},{"id":3076954,"pageURL":"https://pixabay.com/photos/desk-smartphone-iphone-notebook-3076954/","type":"photo","tags":"desk, smartphone, iphone","previewURL":"https://cdn.pixabay.com/photo/2018/01/11/21/27/desk-3076954_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/gb12ec19aa745af70e9e502bd74d23e137a72d881d0dd8926dfb530c15f4fcdce50b7323716f5606547010247c694be864e1fa8aa2f4b876c049df48ea11495ca_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/gb48ac4abb916e4350f4f646b4afddda1cb0a301fe87c66eedc41245dd6cd9554513de3e0313b1e14a6f83b4006b38bc0e86c0ea83dd8e75fab4f05be241d1111_1280.jpg","imageWidth":5304,"imageHeight":3531,"imageSize":2258922,"views":250342,"downloads":158336,"collections":916,"likes":579,"comments":104,"user_id":2218222,"user":"Ylanite","userImageURL":"https://cdn.pixabay.com/user/2021/11/18/21-11-44-855_250x250.png"},{"id":1842202,"pageURL":"https://pixabay.com/photos/camera-phone-picture-capture-1842202/","type":"photo","tags":"camera, phone, picture","previewURL":"https://cdn.pixabay.com/photo/2016/11/20/08/33/camera-1842202_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g88d095b0fe07ed39066c08c7a2ae416f30c43b4ee689a3d20a422a16da304b637bbc801c750e77314e489a1490dbf292e7d6f4da8196a5b026e32ad4607a2b5b_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/gef702f9bff772dd0797797f4beefc8de5b01a01ec07fd816f39b2270849732646ae9784ef5c86d6d469a934abee5dc046e2bd7e0fb367b643d570d5bb802f5f2_1280.jpg","imageWidth":5472,"imageHeight":3648,"imageSize":2581728,"views":95822,"downloads":51074,"collections":1358,"likes":131,"comments":29,"user_id":2286921,"user":"Pexels","userImageURL":"https://cdn.pixabay.com/user/2016/03/26/22-06-36-459_250x250.jpg"},{"id":298243,"pageURL":"https://pixabay.com/photos/smoke-abstract-background-fumes-298243/","type":"photo","tags":"smoke, abstract, background","previewURL":"https://cdn.pixabay.com/photo/2014/03/25/22/53/smoke-298243_150.jpg","previewWidth":100,"previewHeight":150,"webformatURL":"https://pixabay.com/get/gcef0fec817f30607cf27ef239b505fc6585cdeb53e92269362a5c3da71e8e72932e58effbc2d791a8922ee42ae9c8a15_640.jpg","webformatWidth":425,"webformatHeight":640,"largeImageURL":"https://pixabay.com/get/ge0607c159f3e709155bc07fb7394b6e378b89bc119ff2e0edb819e370c5c5474ecbaa3cb3f556040ff37da7ed87d74d287fccfce825e3ddc59c400bb3d0f67d8_1280.jpg","imageWidth":2848,"imageHeight":4288,"imageSize":2236073,"views":567978,"downloads":404912,"collections":742,"likes":637,"comments":105,"user_id":168090,"user":"goranmx","userImageURL":""},{"id":1659054,"pageURL":"https://pixabay.com/photos/grass-lawn-garden-park-ground-1659054/","type":"photo","tags":"grass, lawn, garden","previewURL":"https://cdn.pixabay.com/photo/2016/09/10/12/40/grass-1659054_150.jpg","previewWidth":81,"previewHeight":150,"webformatURL":"https://pixabay.com/get/g57765f6bafe6e96a2ab2f38b69f6728cef15aa8c08459cc94f24c3c9ba8ee5ac4a2bdcf4f6a0d1633405560a799d74badf627d080ace77ffa8647d2b238b02ef_640.jpg","webformatWidth":346,"webformatHeight":640,"largeImageURL":"https://pixabay.com/get/g211697f6f2814c8d9e38b09558eea79d750f82776c296e2c8927027e9c160ddf54fb91bc3f4d647e90c8e3331ff7b444e94c8757fc7f91094030f84eb9bd9d77_1280.jpg","imageWidth":2659,"imageHeight":4911,"imageSize":8444898,"views":418376,"downloads":337762,"collections":774,"likes":607,"comments":89,"user_id":1594796,"user":"jeonsango","userImageURL":"https://cdn.pixabay.com/user/2016/04/22/14-26-25-744_250x250.jpg"},{"id":2369664,"pageURL":"https://pixabay.com/photos/art-multicoloured-to-dye-abstract-2369664/","type":"photo","tags":"art, multicoloured, to dye","previewURL":"https://cdn.pixabay.com/photo/2017/06/03/20/12/art-2369664_150.jpg","previewWidth":99,"previewHeight":150,"webformatURL":"https://pixabay.com/get/g09e28f381fc3ac141c1d3a7125347ddbf2cd266ba418f0d8b47ff933ca8fecc3d974e4754e0766ec69aa837a7eabf7dfd99030d63a0352490569972959109e6c_640.jpg","webformatWidth":424,"webformatHeight":640,"largeImageURL":"https://pixabay.com/get/g4a5a903dd200dd7d782fd868911f72a7fc55be696e00fffdb752ef6694928a5a43dd9670036e15ecbe5bb83407f8f830f4c6526689a026b279f432e110309336_1280.jpg","imageWidth":3264,"imageHeight":4928,"imageSize":4032363,"views":492651,"downloads":433884,"collections":827,"likes":566,"comments":67,"user_id":4894494,"user":"eluela31","userImageURL":"https://cdn.pixabay.com/user/2017/04/24/19-55-29-652_250x250.jpg"},{"id":410311,"pageURL":"https://pixabay.com/photos/iphone-hand-screen-smartphone-apps-410311/","type":"photo","tags":"iphone, hand, screen","previewURL":"https://cdn.pixabay.com/photo/2014/08/05/10/27/iphone-410311_150.jpg","previewWidth":150,"previewHeight":99,"webformatURL":"https://pixabay.com/get/g75489005142dccc8eefd0f2b6fff9ee4c0daaca43fb2f8dd0bd705f0b7a02a7303eae92d3a4b923f6449296a28b00c86_640.jpg","webformatWidth":640,"webformatHeight":426,"largeImageURL":"https://pixabay.com/get/g3c8455f7ceada091a8bc51e82fb4fb8a96979bf8fd264fe9d9f628d7202fdaa3c4e14d8eb70ba50a998ec71a1f0b9e16d22a116d9d43f234cf39fe6ff661ebae_1280.jpg","imageWidth":1920,"imageHeight":1280,"imageSize":416413,"views":537481,"downloads":267696,"collections":637,"likes":604,"comments":167,"user_id":264599,"user":"JESHOOTS-com","userImageURL":"https://cdn.pixabay.com/user/2014/06/08/15-27-10-248_250x250.jpg"},{"id":1052023,"pageURL":"https://pixabay.com/photos/glasses-book-phone-iphone-1052023/","type":"photo","tags":"glasses, book, phone","previewURL":"https://cdn.pixabay.com/photo/2015/11/19/21/14/glasses-1052023_150.jpg","previewWidth":150,"previewHeight":112,"webformatURL":"https://pixabay.com/get/gda8dc2f606f191d4fd17bda93fbff44dac32a026236515fa4100da6beee253e19c25d1411af5bf93411ac869cf1c8b7eae35b77534db40184e5d5636dccc69c5_640.jpg","webformatWidth":640,"webformatHeight":480,"largeImageURL":"https://pixabay.com/get/g44f15e8c9e956ef13cc0c0b2e7801d17f16b7e0949833bdfd03bc441ad52c64ddf2db5a0df1f557d2d84f9e687932c5db00d2b8ce5ed4e8a09dbf0123a32b5c5_1280.jpg","imageWidth":4533,"imageHeight":3400,"imageSize":3219890,"views":284623,"downloads":171034,"collections":649,"likes":593,"comments":83,"user_id":1441456,"user":"DariuszSankowski","userImageURL":"https://cdn.pixabay.com/user/2015/12/21/10-54-58-771_250x250.jpg"},{"id":1850893,"pageURL":"https://pixabay.com/photos/morning-bedroom-bed-door-girl-1850893/","type":"photo","tags":"morning, bedroom, bed","previewURL":"https://cdn.pixabay.com/photo/2016/11/22/22/18/morning-1850893_150.jpg","previewWidth":100,"previewHeight":150,"webformatURL":"https://pixabay.com/get/g98fac31dd73f578a7dd656168a835340c3dc0f2bdd422cb6b446aa0690c9631a96dfdd32b210cc89f552c5ff60afec0cdb0841f2b3cfd57db9dfdd627c2c82c7_640.jpg","webformatWidth":426,"webformatHeight":640,"largeImageURL":"https://pixabay.com/get/ga006449c6a617eb501f54e058454e05995c6427ff3090fc959a011fa76d52891be5fe5e1502aedee8b86c257b64ca61a13e93448690df9d6ec68c542ded128d6_1280.jpg","imageWidth":3264,"imageHeight":4896,"imageSize":1383694,"views":174378,"downloads":107975,"collections":671,"likes":465,"comments":45,"user_id":2286921,"user":"Pexels","userImageURL":"https://cdn.pixabay.com/user/2016/03/26/22-06-36-459_250x250.jpg"},{"id":3354062,"pageURL":"https://pixabay.com/photos/water-waterfall-outdoors-adult-3354062/","type":"photo","tags":"water, waterfall, outdoors","previewURL":"https://cdn.pixabay.com/photo/2018/04/27/08/55/water-3354062_150.jpg","previewWidth":120,"previewHeight":150,"webformatURL":"https://pixabay.com/get/g8b4070c57b725fda738474e4ed9a06b98b7f241209761e39ea8819e9a411b4719b32c652243e594236a6d14ce62ead4943fa25c82d423233e90727ff8103cf37_640.jpg","webformatWidth":512,"webformatHeight":640,"largeImageURL":"https://pixabay.com/get/gf93e75c45fb2c356146a1328a93493bc98e73138adff4a4e37ae1d97c584a8f4e5a313659507f26350d7e36eed15e589e883e4af9119fca73981cd7216a695ed_1280.jpg","imageWidth":3712,"imageHeight":4640,"imageSize":4537291,"views":376598,"downloads":294271,"collections":567,"likes":500,"comments":47,"user_id":8807492,"user":"ollivves","userImageURL":"https://cdn.pixabay.com/user/2018/04/26/09-00-53-532_250x250.jpg"},{"id":1807521,"pageURL":"https://pixabay.com/photos/hot-air-balloons-bagan-sunset-1807521/","type":"photo","tags":"hot air balloons, bagan, sunset","previewURL":"https://cdn.pixabay.com/photo/2016/11/08/05/18/hot-air-balloons-1807521_150.jpg","previewWidth":105,"previewHeight":150,"webformatURL":"https://pixabay.com/get/g24bf79d14195694dbe8afda8867eb0d319d69cd50f71ff35886a4ebfc5bc1251f60bfd84e5a80d161c1734f3b0f2173b5677d461d2cee62bd83dfd0e902cbaf1_640.jpg","webformatWidth":450,"webformatHeight":640,"largeImageURL":"https://pixabay.com/get/gf02950cdd852d4a4b15c805040c88127fa5efea56a0d4e408e5ad01c6de777206f3b62ca88a7031d4dbb14fc4763d68583e77950388a188868a9aa358474a0cd_1280.jpg","imageWidth":2504,"imageHeight":3558,"imageSize":2054554,"views":450370,"downloads":268296,"collections":592,"likes":505,"comments":35,"user_id":3639875,"user":"sasint","userImageURL":"https://cdn.pixabay.com/user/2016/10/30/05-50-54-750_250x250.jpg"}]}
""";